<div class="container" *ngIf="article">
  <div
    class="thumbnail"
    [style.background-image]="'url(' + article.thumbnailURL + ')'"
  ></div>
  <div class="title">
    <h1>{{ article.title }}</h1>
    <p class="pre-wrap">{{ article.description }}</p>
  </div>
  <div class="details">
    <div class="user">
      <a
        mat-icon-button
        class="user__avatar"
        [routerLink]="['/user']"
        [queryParams]="{ id: article.author.uid }"
      >
        <img [src]="article.author.avatarURL" alt="" (error)="updateAvatar()" />
      </a>
      <button mat-button class="user__name">
        <a
          [routerLink]="['/user']"
          [queryParams]="{ id: article.author.uid }"
          >{{ article.author.userName }}</a
        >
      </button>
    </div>
    <p class="update">
      <mat-icon>update</mat-icon>
      <ng-container *ngIf="article.updatedAt; else created">
        <span>{{ article.updatedAt.toDate() | date: 'yyyy年MM月dd日' }}</span>
      </ng-container>
      <ng-template #created>
        <span>{{ article.createdAt.toDate() | date: 'yyyy年MM月dd日' }}</span>
      </ng-template>
    </p>
  </div>
  <mat-divider></mat-divider>
  <div class="contents" *ngFor="let content of article.links; let i = index">
    <div class="contents__content">
      <div class="flex">
        <span class="number">{{ i + 1 }}.</span>
        <div
          class="contents__content--link"
          *ngIf="isLink(content.link); else notLink"
          [class.isLink]="isLink(content.link)"
        >
          <a [href]="content.link" target="_blank">
            {{ content.link }}
          </a>
        </div>
      </div>
      <ng-template #notLink>
        <div class="contents__content--link">
          <p>{{ content.link }}</p>
        </div>
      </ng-template>
      <div *ngIf="content.comment" class="contents__content--comment pre-wrap">
        <p>{{ content.comment }}</p>
      </div>
    </div>
    <mat-divider></mat-divider>
  </div>

  <div class="actions">
    <button
      mat-icon-button
      class="actions__favorite"
      (click)="clickedLike(article)"
      [class.liked]="isLiked"
      matTooltip="いいねする"
    >
      <ng-container *ngIf="isLiked; else default">
        <mat-icon class="liked">favorite</mat-icon>
        <span>{{ favorite }}</span>
      </ng-container>
      <ng-template #default>
        <mat-icon class="default">favorite_border</mat-icon>
        <span>{{ favorite }}</span>
      </ng-template>
    </button>
    <button mat-icon-button class="actions__share" matTooltip="Twitterでシェア">
      <a
        href="https://twitter.com/share?url=https://miru-2ac6c.web.app/article/{{
          article.articleId
        }}/&text={{ article.title }}"
        rel="nofollow"
        target="_blank"
      >
        <mat-icon>share</mat-icon>
      </a>
    </button>
  </div>
  <button
    *ngIf="isMyArticle"
    [routerLink]="['/article/edit']"
    [queryParams]="{ id: article.articleId }"
    mat-raised-button
    class="edit"
  >
    この記事を編集する
  </button>
</div>
